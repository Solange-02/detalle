<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Solange💖</title>
<style>
  :root{ --accent:#ff4f81; --text:#3b2b3b; --soft:#fff4f9; }
  *{box-sizing:border-box} body{margin:0;font-family:Poppins,system-ui,Arial; background:linear-gradient(120deg,#ffd6e0,#ffeef6 40%,#f7f0ff 80%);min-height:100vh;overflow-x:hidden;color:var(--text)}
  /* background gradient animation & particles */
  .bg{position:fixed;inset:0;z-index:0;pointer-events:none;overflow:hidden}
  .bg .blur {position:absolute;inset:-20%;filter:blur(60px);background:linear-gradient(60deg, rgba(255,200,220,0.35), rgba(200,230,255,0.18), rgba(255,220,240,0.28)); animation:grad 22s linear infinite;opacity:.9}
  @keyframes grad{0%{transform:translateX(-25%) rotate(0)}50%{transform:translateX(10%) rotate(8deg)}100%{transform:translateX(-25%) rotate(0)}}
  .particle{position:absolute;border-radius:50%;background:rgba(255,255,255,0.5);filter:blur(.7px);animation:floatUp linear infinite}
  @keyframes floatUp{0%{transform:translateY(0);opacity:0}10%{opacity:1}100%{transform:translateY(-120vh);opacity:0}}

  /* LOGIN */
  #loginWrap{position:relative;z-index:10;min-height:100vh;display:flex;align-items:center;justify-content:center;padding:28px}
  .login-card{width:100%;max-width:440px;background:linear-gradient(145deg,#667eea,#764ba2);color:#fff;padding:26px;border-radius:18px;box-shadow:0 18px 40px rgba(0,0,0,.18);text-align:center}
  .login-card h2{margin:0 0 12px;font-size:22px}
  .login-card input{width:220px;padding:12px;border-radius:10px;border:none;text-align:center;font-size:16px}
  .keypad{margin-top:14px;display:grid;grid-template-columns:repeat(3,64px);gap:10px;justify-content:center}
  .keypad button{height:56px;border-radius:12px;border:none;background:#fff;color:#333;font-size:18px;cursor:pointer;box-shadow:0 8px 18px rgba(0,0,0,.12)}
  .keypad .zero{grid-column:span 2} .keypad .del{background:var(--accent);color:#fff}
  .enter-btn{margin-top:14px;padding:10px 22px;border-radius:12px;background:#00c6ff;color:#fff;border:none;cursor:pointer;box-shadow:0 8px 18px rgba(0,0,0,.12)}
  .fade-out{animation:fadeOut .7s forwards} @keyframes fadeOut{to{opacity:0;transform:translateY(-8px);pointer-events:none}}

  /* MAIN */
  #content{display:none;position:relative;z-index:5;padding:20px;max-width:1100px;margin:0 auto;text-align:center}
  header{margin-top:40px}
  h1{font-size:2.1rem;margin:0;display:inline-block;background:linear-gradient(90deg,#00c6ff,#0072ff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;padding:6px 12px;border-radius:10px}
  h1 .emoji{-webkit-text-fill-color:initial;background:none;margin-left:8px;font-size:1.05em;vertical-align:middle;}

  /* LETTER (initial) */
  #letterModal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:60;background:rgba(0,0,0,.5)}
  .letter-card{width:92%;max-width:620px;background:linear-gradient(180deg,#fff8fb,#fff0f6);padding:26px;border-radius:18px;box-shadow:0 18px 40px rgba(0,0,0,.25);border:2px solid rgba(255,79,129,.08);text-align:center}
  .letter-card h2{color:var(--accent);margin:0 0 10px} .letter-card p{color:#444;line-height:1.6}

  /* Carousel 3D */
  .carousel-wrap{margin:80px auto 10px auto;width:min(920px,92%);height:420px;perspective:1400px;position:relative}
  .carousel-3d{width:100%;height:100%;position:relative;transform-style:preserve-3d;transition:transform .9s cubic-bezier(.22,.9,.3,1);margin:0 auto}
  .slide{position:absolute;left:50%;top:50%;transform-style:preserve-3d;width:320px;height:380px;margin-left:-160px;margin-top:-190px;border-radius:16px;overflow:hidden;display:flex;align-items:center;justify-content:center;background:var(--soft);box-shadow:0 18px 40px rgba(0,0,0,.18)}
  .slide img{width:100%;height:100%;object-fit:contain;background:#fff0f6;display:block}

  /* nav */
  .nav{margin-top:12px;display:flex;gap:12px;justify-content:center}
  .nav button{width:46px;height:46px;border-radius:50%;border:none;background:rgba(255,255,255,.95);box-shadow:0 8px 18px rgba(0,0,0,.12);cursor:pointer}

  /* timer and music */
  #timer{margin-top:28px;font-weight:700;font-size:1.05rem;display:inline-block;background:rgba(255,255,255,.95);padding:10px 14px;border-radius:22px;box-shadow:0 10px 30px rgba(0,0,0,.08)}
  .music-btn{margin-top:18px;padding:10px 16px;border-radius:20px;border:none;background:#0072ff;color:#fff;cursor:pointer;box-shadow:0 8px 18px rgba(0,0,0,.08)}

  /* hearts */
  .floating-heart{position:fixed;bottom:-10px;font-size:18px;z-index:2;pointer-events:none;opacity:0.9;animation:floatH linear infinite}
  @keyframes floatH{from{transform:translateY(0)}to{transform:translateY(-800px) scale(1.5);opacity:0}}

  .cursor-heart{position:fixed;pointer-events:none;z-index:9999;transform:translate(-50%,-50%);transition:transform .25s linear,opacity .6s linear}

  /* confetti area */
  .confetti{position:fixed;pointer-events:none;z-index:9999;inset:0}

  /* responsive */
  @media (max-width:820px){ .carousel-wrap{height:360px} .slide{width:260px;height:320px;margin-left:-130px;margin-top:-160px} }
  @media (max-width:420px){ h1{font-size:1.4rem;margin-top:24px} .carousel-wrap{height:320px;margin-top:60px} .slide{width:200px;height:260px;margin-left:-100px;margin-top:-130px} #timer{font-size:.95rem} }
</style>
</head>
<body>

  <!-- animated background -->
  <div class="bg" aria-hidden="true">
    <div class="blur" aria-hidden="true"></div>
    <div id="bgParticles"></div>
  </div>

  <!-- LOGIN -->
  <div id="loginWrap">
    <div class="login-card" id="loginCard">
      <h2>Ingresa la contraseña 💞</h2>
      <input id="pwd" type="password" placeholder="" readonly>
      <div class="keypad" aria-hidden="false">
        <button onclick="press('1')">1</button><button onclick="press('2')">2</button><button onclick="press('3')">3</button>
        <button onclick="press('4')">4</button><button onclick="press('5')">5</button><button onclick="press('6')">6</button>
        <button onclick="press('7')">7</button><button onclick="press('8')">8</button><button onclick="press('9')">9</button>
        <button class="zero" onclick="press('0')">0</button><button class="del" onclick="backspace()">⌫</button>
      </div>
      <button class="enter-btn" onclick="submitPwd()">Entrar</button>
    </div>
  </div>

  <!-- LETTER (initial) -->
  <div id="letterModal" style="display:none;">
    <div class="letter-card">
      <h2>💌 Una carta para ti 💌</h2>
      <p id="letterText">
Hoy quiero regalarte este pequeño rincón lleno fotos tuyas.
Gracias por cada sonrisa, por tu compañía y por hacer mis días más bonitos.
Eres alguien muy especial renegona. 
      </p>
      <div class="letter-actions">
        <button onclick="closeLetter()" style="background:var(--accent);color:#fff;border:none;padding:10px 14px;border-radius:999px;">Ver recuerdos</button>
      </div>
    </div>
  </div>

  <!-- MAIN CONTENT -->
  <div id="content">
    <header><h1>Una Galeria de ti <3 <span class="emoji">💞</span></h1></header>

    <!-- 3D carousel -->
    <div class="carousel-wrap" id="carouselWrap" aria-hidden="false">
      <div class="carousel-3d" id="carousel3d" role="list"></div>
    </div>
    <div class="nav">
      <button id="prevBtn" aria-label="Anterior">&#10094;</button>
      <button id="nextBtn" aria-label="Siguiente">&#10095;</button>
    </div>

    <div id="timer" aria-live="polite"></div>
    <button class="music-btn" id="musicBtn">🎶 Reproducir / Pausar</button>
  </div>

  <!-- trail/confetti/particles -->
  <div id="cursorTrail" aria-hidden="true"></div>
  <div class="confetti" id="confetti"></div>
  <div id="particles"></div>

  <!-- audio -->
  <audio id="bgAudio" src="musica.mp3" preload="auto" loop></audio>

<script>
/* ====== Config ====== */
const PASSWORD = "020922";
const IMAGES = [
  "fotoss/img1.jpeg",
  "fotoss/img2.jpeg",
  "fotoss/img3.jpeg",
  "fotoss/img4.jpeg",
  "fotoss/img5.jpeg",
  "fotoss/img6.jpeg"
];

/* ====== Login keypad ====== */
const pwd = document.getElementById('pwd');
function press(n){ pwd.value += n; }
function backspace(){ pwd.value = pwd.value.slice(0,-1); }
function submitPwd(){
  if(pwd.value === PASSWORD){
    document.getElementById('loginCard').classList.add('fade-out');
    setTimeout(()=> {
      document.getElementById('loginWrap').style.display = 'none';
      document.getElementById('letterModal').style.display = 'flex';
      try{ document.getElementById('bgAudio').volume = 0.45; document.getElementById('bgAudio').play(); }catch(e){}
      createBgParticles();
    },700);
  } else { alert('Contraseña incorrecta ❌'); pwd.value = ''; }
}

/* ====== Close letter => show content & init 3D carousel ====== */
function closeLetter(){
  document.getElementById('letterModal').style.display = 'none';
  document.getElementById('content').style.display = 'block';
  initCarousel3D();
  startAutoRotate();
}

/* ====== Background particles ====== */
function createBgParticles(){
  const c = document.getElementById('bgParticles');
  const count = 24;
  for(let i=0;i<count;i++){
    const el = document.createElement('div');
    el.className = 'particle';
    const size = 3 + Math.random()*8;
    el.style.width = el.style.height = size + 'px';
    el.style.left = Math.random()*100 + 'vw';
    el.style.top = (75 + Math.random()*25) + 'vh';
    el.style.animationDuration = (8 + Math.random()*8) + 's';
    el.style.animationDelay = Math.random()*3 + 's';
    el.style.background = `rgba(255,255,255,${0.25 + Math.random()*0.5})`;
    c.appendChild(el);
  }
}

/* ====== Timer ====== */
const startDate = new Date("2022-09-02T00:00:00");
function updateTimer(){
  const now = new Date();
  let diff = Math.floor((now - startDate)/1000);
  const years = Math.floor(diff/(365*24*3600)); diff -= years * 365*24*3600;
  const months = Math.floor(diff/(30*24*3600)); diff -= months * 30*24*3600;
  const days = Math.floor(diff/(24*3600)); diff -= days * 24*3600;
  const hours = Math.floor(diff/3600); diff -= hours * 3600;
  const minutes = Math.floor(diff/60); const seconds = diff % 60;
  document.getElementById('timer').textContent = `${years} años, ${months} meses, ${days} días, ${hours}h ${minutes}m ${seconds}s juntos 💕`;
}
setInterval(updateTimer,1000);
updateTimer();

/* ====== Music control ====== */
const bgAudio = document.getElementById('bgAudio');
const musicBtn = document.getElementById('musicBtn');
musicBtn.addEventListener('click', ()=>{
  if(bgAudio.paused){ bgAudio.play().catch(()=>{}); musicBtn.textContent = '🔊 Pausar'; }
  else{ bgAudio.pause(); musicBtn.textContent = '🎶 Reproducir / Pausar'; }
});

/* ====== Floating hearts ====== */
(function spawnHearts(){
  const colors = ['#ff4f81','#ff9a9e','#ffd36a','#ffb3e6','#c6ffdd'];
  setInterval(()=>{
    const el = document.createElement('div');
    el.className = 'floating-heart';
    el.innerText = '💖';
    el.style.left = Math.random()*100 + 'vw';
    el.style.color = colors[Math.floor(Math.random()*colors.length)];
    el.style.fontSize = (12 + Math.random()*24) + 'px';
    el.style.animationDuration = (4 + Math.random()*4) + 's';
    document.body.appendChild(el);
    setTimeout(()=> el.remove(), 7000);
  },900);
})();

/* ====== Cursor trail hearts ====== */
const trail = document.getElementById('cursorTrail');
document.addEventListener('mousemove', (e)=>{
  const el = document.createElement('div');
  el.className = 'cursor-heart';
  const items = ['💗','💖','💝','💞','💕'];
  el.textContent = items[Math.floor(Math.random()*items.length)];
  el.style.left = e.clientX + 'px'; el.style.top = e.clientY + 'px';
  el.style.fontSize = (12 + Math.random()*14) + 'px';
  trail.appendChild(el);
  requestAnimationFrame(()=> { el.style.transform = `translate(${(Math.random()*40-20)}px,-30px) scale(1.05)`; el.style.opacity = '0.6'; });
  setTimeout(()=> { el.style.opacity = '0'; setTimeout(()=> el.remove(), 600); }, 500);
});

/* ====== Confetti helper (not auto-called) ====== */
function launchConfetti(){
  const container = document.getElementById('confetti');
  const colors = ['#ff6b9a','#ffd36a','#7ed6ff','#ffb3e6','#c6ffdd'];
  const n = 50;
  for(let i=0;i<n;i++){
    const c = document.createElement('div');
    c.style.position = 'absolute';
    c.style.left = (50 + (Math.random()*60-30)) + 'vw';
    c.style.top = (20 + Math.random()*10) + 'vh';
    c.style.width = (6 + Math.random()*10) + 'px';
    c.style.height = (8 + Math.random()*12) + 'px';
    c.style.background = colors[Math.floor(Math.random()*colors.length)];
    c.style.opacity = 1;
    container.appendChild(c);
    const dur = 1500 + Math.random()*1600;
    c.animate([{transform:`translateY(0)`, opacity:1},{transform:`translateY(${300+Math.random()*500}px)`, opacity:0.1}], {duration:dur, easing:'cubic-bezier(.17,.67,.83,.67)'});
    setTimeout(()=> c.remove(), dur+80);
  }
}

/* ====== Carousel 3D interactive + auto ====== */
let carouselEl, nSlides, anglePer, radius;
let currentRotation = 0; // degrees, positive is clockwise
let rafId, lastTime = 0;
let isDragging = false, lastX = 0, velocity = 0;

function initCarousel3D(){
  carouselEl = document.getElementById('carousel3d');
  carouselEl.innerHTML = '';
  nSlides = IMAGES.length;
  anglePer = 360 / nSlides;
  IMAGES.forEach((src,i)=>{
    const s = document.createElement('div'); s.className = 'slide';
    const img = document.createElement('img'); img.src = src; img.alt = `Foto ${i+1}`;
    s.appendChild(img); carouselEl.appendChild(s);
  });
  // position after small delay
  setTimeout(positionSlides, 80);
  window.addEventListener('resize', ()=> { clearTimeout(window._pos); window._pos = setTimeout(positionSlides, 120); });

  // pointer events for drag/swipe
  const wrap = document.getElementById('carouselWrap');
  wrap.addEventListener('pointerdown', pointerDown);
  window.addEventListener('pointermove', pointerMove);
  window.addEventListener('pointerup', pointerUp);

  document.getElementById('prevBtn').addEventListener('click', ()=> manualRotate(-1));
  document.getElementById('nextBtn').addEventListener('click', ()=> manualRotate(1));
}

function positionSlides(){
  const slides = Array.from(document.querySelectorAll('.slide'));
  if(!slides.length) return;
  const slideW = slides[0].getBoundingClientRect().width;
  radius = Math.round((slideW) / (2 * Math.tan(Math.PI / nSlides))) + 20;
  slides.forEach((s,i)=>{
    const ang = i * anglePer;
    s.style.transform = `rotateY(${ang}deg) translateZ(${radius}px)`;
  });
  updateCarousel();
}

function updateCarousel(){
  if(carouselEl) carouselEl.style.transform = `translateZ(-${radius}px) rotateY(${currentRotation}deg)`;
}

function startAutoRotate(){
  lastTime = performance.now();
  cancelAnimationFrame(rafId);
  rafId = requestAnimationFrame(loop);
}
function stopAutoRotate(){ cancelAnimationFrame(rafId); rafId = null; }

function loop(t){
  const dt = t - lastTime; lastTime = t;
  if(!isDragging){
    // auto clockwise rotation: tune speed here (deg per ms)
    currentRotation += 0.015 * dt; // ~9 deg/s
    // apply small inertia if any
    if(Math.abs(velocity) > 0.001){ currentRotation += velocity; velocity *= 0.95; }
    updateCarousel();
  } else {
    // while dragging, apply small velocity damping
    if(Math.abs(velocity) > 0.001){ currentRotation += velocity; velocity *= 0.95; updateCarousel(); }
  }
  rafId = requestAnimationFrame(loop);
}

/* pointer handlers */
function pointerDown(e){
  isDragging = true;
  lastX = e.clientX;
  velocity = 0;
  // stop auto rotation while dragging
}
function pointerMove(e){
  if(!isDragging) return;
  const dx = e.clientX - lastX;
  lastX = e.clientX;
  const sensitivity = 0.28; // degrees per px
  const deltaDeg = dx * sensitivity;
  currentRotation += deltaDeg;
  velocity = deltaDeg; // store for inertia
  updateCarousel();
}
function pointerUp(e){
  if(!isDragging) return;
  isDragging = false;
  // resume auto after short timeout
  setTimeout(()=> { /* auto resumes in loop already */ }, 1200);
}

/* manual rotate to next/prev */
function manualRotate(step){
  // calculate nearest index currently at front
  const normalized = ((-currentRotation % 360) + 360) % 360;
  const currentIndex = Math.round(normalized / anglePer) % nSlides;
  const targetIndex = (currentIndex + step + nSlides) % nSlides;
  const desired = - targetIndex * anglePer;
  animateTo(desired, 600);
}
function animateTo(target, duration){
  const start = performance.now();
  const from = currentRotation;
  // choose shortest path
  let diff = ((target - from + 54000) % 360) - 180;
  function step(ts){
    const p = Math.min(1, (ts - start) / duration);
    const ease = p < .5 ? 2*p*p : -1 + (4-2*p)*p;
    currentRotation = from + diff * ease;
    updateCarousel();
    if(p < 1) requestAnimationFrame(step);
  }
  requestAnimationFrame(step);
}

/* accessibility keyboard */
document.addEventListener('keydown', e=>{
  if(document.getElementById('content').style.display !== 'block') return;
  if(e.key === 'ArrowLeft') manualRotate(-1);
  if(e.key === 'ArrowRight') manualRotate(1);
});

/* ====== Initialize small background particles immediately (decor) ====== */
(function initDecor(){
  const container = document.getElementById('particles');
  for(let i=0;i<20;i++){
    const el = document.createElement('div');
    el.className = 'particle';
    const s = 3 + Math.random()*7;
    el.style.width = el.style.height = s + 'px';
    el.style.left = Math.random()*100 + 'vw';
    el.style.top = (75 + Math.random()*25) + 'vh';
    el.style.animationDuration = (8+Math.random()*7) + 's';
    el.style.animationDelay = Math.random()*3 + 's';
    el.style.background = `rgba(255,255,255,${0.25 + Math.random()*0.45})`;
    document.getElementById('bgParticles').appendChild(el);
  }
})();

/* ====== Start nothing else until letter closed. ====== */
</script>
</body>
</html>

